class NewsLoader{constructor(e="vi"){this.lang=e,this.articles=[],this.currentCategory="all",this.displayLimit=4,this.currentDisplayCount=4}async loadArticles(){try{const e=window.location.pathname.includes("/en/")?"../tables/news_articles?limit=100":"tables/news_articles?limit=100",t=await fetch(e),a=await t.json();a.data&&(this.articles=a.data.filter(e=>"published"===e.status).sort((e,t)=>new Date(t.published_date)-new Date(e.published_date)),this.renderArticles(),this.initCategoryFilter())}catch(e){console.error("Error loading articles:",e),this.showError()}}renderArticles(){const e=document.querySelector(".news-grid");if(!e)return;const t="all"===this.currentCategory?this.articles:this.articles.filter(e=>e.category===this.currentCategory);if(0===t.length){const t="vi"===this.lang?"Không có bài viết nào trong danh mục này.":"No articles in this category.";return void(e.innerHTML=`\n                <div style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: #6c757d;">\n                    <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>\n                    <p>${t}</p>\n                </div>\n            `)}const a=t.slice(0,this.currentDisplayCount),i=t.length>this.currentDisplayCount,s=a.map(e=>{const t="vi"===this.lang?e.title_vi:e.title_en,a="vi"===this.lang?e.excerpt_vi:e.excerpt_en;"vi"===this.lang?e.category_vi:e.category_en;"vi"===this.lang?e.slug_vi:e.slug_en;const i="vi"===this.lang?`article-view.html?id=${e.id}`:`article-view.html?id=${e.id}`,s=new Date(e.published_date),r="vi"===this.lang?s.toLocaleDateString("vi-VN",{day:"numeric",month:"long",year:"numeric"}):s.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),n="vi"===this.lang?"phút đọc":"min read",c=e.featured_image?`<img src="${e.featured_image}" alt="${t}" loading="lazy" style="width: 100%; height: 100%; object-fit: cover;">`:'<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M7 7h.01"/><path d="M17 7h.01"/><path d="M7 17h.01"/><path d="M17 17h.01"/></svg>';return`\n                <article class="news-card" data-category="${e.category}">\n                    <div class="news-card__image">\n                        ${c}\n                    </div>\n                    <div class="news-card__content">\n                        <h3 class="news-card__title">\n                            <a href="${i}">${t}</a>\n                        </h3>\n                        <p class="news-card__excerpt">\n                            ${a}\n                        </p>\n                        <div class="news-card__meta">\n                            <span class="news-card__date">${r}</span>\n                            <span class="news-card__read-time">${e.read_time} ${n}</span>\n                        </div>\n                    </div>\n                </article>\n            `}).join("");e.innerHTML=s,this.renderLoadMoreButton(i,t.length)}renderLoadMoreButton(e,t){let a=document.querySelector(".load-more-container");if(a||(a=document.createElement("div"),a.className="load-more-container",a.style.cssText="text-align: center; margin-top: 2rem; grid-column: 1 / -1;",document.querySelector(".news-grid").parentElement.appendChild(a)),e){const e=t-this.currentDisplayCount,i="vi"===this.lang?`Xem thêm (${e} bài)`:`Load More (${e} articles)`;a.innerHTML=`\n                <button class="load-more-btn" style="\n                    padding: 0.8rem 2rem;\n                    background: #FF6B35;\n                    color: white;\n                    border: none;\n                    border-radius: 8px;\n                    font-size: 1rem;\n                    font-weight: 600;\n                    cursor: pointer;\n                    transition: all 0.3s;\n                    box-shadow: 0 2px 8px rgba(255, 107, 53, 0.2);\n                " onmouseover="this.style.background='#E55A25'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(255, 107, 53, 0.3)';" \n                   onmouseout="this.style.background='#FF6B35'; this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(255, 107, 53, 0.2)';">\n                    ${i}\n                </button>\n            `,a.querySelector(".load-more-btn").addEventListener("click",()=>{this.loadMore()})}else a.innerHTML=""}loadMore(){this.currentDisplayCount+=4,this.renderArticles()}initCategoryFilter(){document.querySelectorAll(".category-btn").forEach(e=>{e.addEventListener("click",()=>{document.querySelectorAll(".category-btn").forEach(e=>e.classList.remove("active")),e.classList.add("active"),this.currentCategory=e.dataset.category,this.currentDisplayCount=4,this.renderArticles()})})}showError(){const e=document.querySelector(".news-grid");if(e){const t="vi"===this.lang?"Không thể tải bài viết. Vui lòng thử lại sau.":"Unable to load articles. Please try again later.";e.innerHTML=`\n                <div style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: #dc3545;">\n                    <i class="fas fa-exclamation-circle" style="font-size: 3rem; margin-bottom: 1rem;"></i>\n                    <p>${t}</p>\n                </div>\n            `}}}document.addEventListener("DOMContentLoaded",()=>{const e=window.location.pathname.includes("/en/")?"en":"vi";new NewsLoader(e).loadArticles()});